# ğŸ“Š Arquitectura del Sistema

## Diagrama de Componentes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ADMINISTRADOR                              â”‚
â”‚                                                                      â”‚
â”‚  1. Crear Cuestionario                                              â”‚
â”‚     $ python create_questionnaire.py                                â”‚
â”‚                                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚  Genera Claves BFV                   â”‚                        â”‚
â”‚     â”‚  â€¢ Public Key  â†’ Frontend            â”‚                        â”‚
â”‚     â”‚  â€¢ Secret Key  â†’ Backend (segura)    â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                          â†“                                           â”‚
â”‚     Guarda en Base de Datos (SQLite/PostgreSQL)                     â”‚
â”‚                          â†“                                           â”‚
â”‚     Comparte link: http://server/questionnaire.html?id=abc123       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            USUARIOS                                  â”‚
â”‚                                                                      â”‚
â”‚  2. Responder Cuestionario                                          â”‚
â”‚     Navegador web â†’ http://server/questionnaire.html?id=abc123      â”‚
â”‚                                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚  Frontend (JavaScript)               â”‚                        â”‚
â”‚     â”‚                                       â”‚                        â”‚
â”‚     â”‚  a) Recibe Public Key                â”‚                        â”‚
â”‚     â”‚  b) Usuario selecciona respuestas    â”‚                        â”‚
â”‚     â”‚  c) One-hot encode: [0,0,1,0,...]    â”‚                        â”‚
â”‚     â”‚  d) Cifra con BFV                    â”‚                        â”‚
â”‚     â”‚  e) EnvÃ­a ciphertexts al servidor    â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                          â†“                                           â”‚
â”‚           POST /api/submit-answers                                   â”‚
â”‚           { encrypted_answers: [...] }                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          SERVIDOR (Backend)                          â”‚
â”‚                                                                      â”‚
â”‚  3. Recibir y Acumular Respuestas Cifradas                          â”‚
â”‚     Flask API + SQLAlchemy                                           â”‚
â”‚                                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚  Suma HomomÃ³rfica (BFV Evaluator)    â”‚                        â”‚
â”‚     â”‚                                       â”‚                        â”‚
â”‚     â”‚  Si primera respuesta:               â”‚                        â”‚
â”‚     â”‚    accumulated = ciphertext_1        â”‚                        â”‚
â”‚     â”‚                                       â”‚                        â”‚
â”‚     â”‚  Si ya hay respuestas:               â”‚                        â”‚
â”‚     â”‚    accumulated = accumulated +       â”‚                        â”‚
â”‚     â”‚                  ciphertext_new      â”‚                        â”‚
â”‚     â”‚                                       â”‚                        â”‚
â”‚     â”‚  âš ï¸ Servidor NO ve respuestas!       â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                          â†“                                           â”‚
â”‚     Guarda accumulated (cifrado) en DB                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ADMINISTRADOR                              â”‚
â”‚                                                                      â”‚
â”‚  4. Ver Resultados                                                  â”‚
â”‚     $ python view_results.py --link abc123                          â”‚
â”‚                                                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚     â”‚  Descifrado con Secret Key           â”‚                        â”‚
â”‚     â”‚                                       â”‚                        â”‚
â”‚     â”‚  1. Lee accumulated de DB            â”‚                        â”‚
â”‚     â”‚  2. Descifra con secret_key          â”‚                        â”‚
â”‚     â”‚  3. Decode vector                    â”‚                        â”‚
â”‚     â”‚  4. Muestra totales:                 â”‚                        â”‚
â”‚     â”‚     OpciÃ³n 1: 15 votos (30%)         â”‚                        â”‚
â”‚     â”‚     OpciÃ³n 2: 25 votos (50%)         â”‚                        â”‚
â”‚     â”‚     OpciÃ³n 3: 10 votos (20%)         â”‚                        â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Flujo de Datos Detallado

### ğŸ“¤ EnvÃ­o de Respuesta (Usuario â†’ Servidor)

```
Usuario en Navegador
         â”‚
         â”‚ 1. Selecciona: "OpciÃ³n 2"
         â†“
    [Frontend JS]
         â”‚
         â”‚ 2. One-hot encode
         â”‚    [0, 0, 1, 0, 0, 0, 0, 0]
         â†“
    BatchEncoder
         â”‚
         â”‚ 3. Encode (CRT batching)
         â”‚    â†’ Plaintext (polinomio)
         â†“
    BFVEncryptor
         â”‚
         â”‚ 4. Encrypt con public_key
         â”‚    plaintext â†’ ciphertext
         â”‚    (c0, c1)
         â†“
    Serializar JSON
         â”‚
         â”‚ 5. POST /api/submit-answers
         â”‚    {
         â”‚      questionnaire_id: "abc123",
         â”‚      encrypted_answers: [
         â”‚        { c0: {...}, c1: {...} }
         â”‚      ]
         â”‚    }
         â†“
    [Backend Flask]
         â”‚
         â”‚ 6. Deserializar ciphertexts
         â†“
    BFVEvaluator
         â”‚
         â”‚ 7. Suma homomÃ³rfica
         â”‚    accumulated = accumulated + new
         â†“
    Base de Datos
         â”‚
         â”‚ 8. Guardar accumulated (cifrado)
         â””â”€â†’ SQLite: tabla questionnaires
```

### ğŸ“¥ Lectura de Resultados (Administrador)

```
Administrador
         â”‚
         â”‚ 1. python view_results.py --link abc123
         â†“
    [Backend Script]
         â”‚
         â”‚ 2. Lee accumulated de DB
         â†“
    BFVDecryptor
         â”‚
         â”‚ 3. Descifra con secret_key
         â”‚    ciphertext â†’ plaintext
         â†“
    BatchEncoder
         â”‚
         â”‚ 4. Decode (CRT)
         â”‚    plaintext â†’ [5, 10, 15, 3, ...]
         â†“
    Pantalla
         â”‚
         â”‚ 5. Muestra resultados
         â””â”€â†’ OpciÃ³n 1: 5 votos
             OpciÃ³n 2: 10 votos
             OpciÃ³n 3: 15 votos
             ...
```

---

## Estructura de Base de Datos

### Tabla: `questionnaires`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id (PK)                â”‚ INTEGER (autoincrement)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ link                   â”‚ STRING (unique, indexed)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ deadline               â”‚ DATETIME                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ questions_json         â”‚ TEXT (JSON serializado)            â”‚
â”‚                        â”‚ [                                  â”‚
â”‚                        â”‚   {                                â”‚
â”‚                        â”‚     text: "Â¿Pregunta?",            â”‚
â”‚                        â”‚     options: ["A", "B", ...]       â”‚
â”‚                        â”‚   }                                â”‚
â”‚                        â”‚ ]                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ poly_degree            â”‚ INTEGER (8, 16, 32, ...)           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ plain_modulus          â”‚ INTEGER (primo, ej: 17)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ciph_modulus           â”‚ STRING (nÃºmero grande)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ public_key_json        â”‚ TEXT (JSON)                        â”‚
â”‚                        â”‚ {                                  â”‚
â”‚                        â”‚   p0: { coeffs: [...] },           â”‚
â”‚                        â”‚   p1: { coeffs: [...] }            â”‚
â”‚                        â”‚ }                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ secret_key_json        â”‚ TEXT (JSON) ğŸ” SECRETO             â”‚
â”‚                        â”‚ {                                  â”‚
â”‚                        â”‚   coeffs: [...]                    â”‚
â”‚                        â”‚ }                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ accumulated_responses  â”‚ TEXT (JSON)                        â”‚
â”‚ _json                  â”‚ [                                  â”‚
â”‚                        â”‚   { c0: {...}, c1: {...} },  // Q1 â”‚
â”‚                        â”‚   { c0: {...}, c1: {...} },  // Q2 â”‚
â”‚                        â”‚   ...                              â”‚
â”‚                        â”‚ ]                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ num_responses          â”‚ INTEGER (contador)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ created_at             â”‚ DATETIME                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tabla: `responses` (metadata)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id (PK)              â”‚ INTEGER (autoincrement)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ questionnaire_id     â”‚ INTEGER (FK)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ submitted_at         â”‚ DATETIME                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Endpoints

### 1. GET `/api/questionnaire/<link>`

**Request:**
```
GET /api/questionnaire/abc123
```

**Response:**
```json
{
  "id": 1,
  "link": "abc123",
  "deadline": "2025-12-31T23:59:59",
  "questions": [
    {
      "text": "Â¿Pregunta 1?",
      "options": ["A", "B", "C", "D", "E", "F", "G", "H"]
    }
  ],
  "public_key": {
    "p0": { "ring_degree": 8, "coeffs": [...] },
    "p1": { "ring_degree": 8, "coeffs": [...] }
  },
  "params": {
    "poly_degree": 8,
    "plain_modulus": 17,
    "ciph_modulus": 8000000000000
  }
}
```

### 2. POST `/api/submit-answers`

**Request:**
```json
{
  "questionnaire_id": "abc123",
  "encrypted_answers": [
    {
      "c0": { "ring_degree": 8, "coeffs": [...] },
      "c1": { "ring_degree": 8, "coeffs": [...] }
    }
  ]
}
```

**Response:**
```json
{
  "success": true,
  "message": "Answers submitted successfully",
  "total_responses": 42
}
```

### 3. GET `/api/questionnaire/<link>/stats`

**Request:**
```
GET /api/questionnaire/abc123/stats
```

**Response:**
```json
{
  "link": "abc123",
  "num_responses": 42,
  "deadline": "2025-12-31T23:59:59",
  "is_expired": false
}
```

---

## Seguridad y Privacidad

### ğŸ” GarantÃ­as CriptogrÃ¡ficas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FRONTEND (Usuario)                                      â”‚
â”‚  âœ“ Tiene: public_key                                     â”‚
â”‚  âœ“ Puede: cifrar mensajes                                â”‚
â”‚  âœ— NO puede: descifrar mensajes                          â”‚
â”‚  âœ— NO puede: ver respuestas de otros                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND (Servidor)                                      â”‚
â”‚  âœ“ Tiene: ciphertexts (cifrados)                         â”‚
â”‚  âœ“ Puede: sumar ciphertexts homomÃ³rficamente             â”‚
â”‚  âœ— NO puede: descifrar sin secret_key                    â”‚
â”‚  âœ— NO puede: ver respuestas individuales                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ADMINISTRADOR                                           â”‚
â”‚  âœ“ Tiene: secret_key (guardada de forma segura)         â”‚
â”‚  âœ“ Puede: descifrar accumulated (totales)               â”‚
â”‚  âœ— NO puede: ver respuestas individuales originales     â”‚
â”‚                (solo totales acumulados)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ›¡ï¸ Propiedades del Sistema

1. **Confidencialidad**: Respuestas individuales nunca en texto plano
2. **AgregaciÃ³n Privada**: Sumas sin descifrar
3. **Verificabilidad**: Administrador puede verificar totales
4. **No Repudio**: Cada respuesta se registra (timestamp)

---

## Ejemplos de Uso

### Caso 1: Encuesta de SatisfacciÃ³n AnÃ³nima

```
Pregunta: "Â¿CÃ³mo calificarÃ­as tu experiencia?"
Opciones: 1â­ 2â­ 3â­ 4â­ 5â­ N/A N/A N/A

Usuario 1 selecciona: 5â­ â†’ cifra [0,0,0,0,1,0,0,0]
Usuario 2 selecciona: 4â­ â†’ cifra [0,0,0,1,0,0,0,0]
Usuario 3 selecciona: 5â­ â†’ cifra [0,0,0,0,1,0,0,0]

Servidor acumula (sin ver):
  accumulated = sum([ciph1, ciph2, ciph3])

Administrador descifra:
  [0, 0, 0, 1, 2, 0, 0, 0]
  â†’ 1 persona votÃ³ 4â­, 2 personas votaron 5â­
  â†’ Promedio: 4.67â­
```

### Caso 2: VotaciÃ³n Privada

```
Pregunta: "Â¿A favor de la propuesta X?"
Opciones: SÃ­, No, AbstenciÃ³n, N/A, N/A, N/A, N/A, N/A

100 usuarios votan (cada uno cifra su respuesta)

Servidor acumula sin ver votos individuales

Administrador descifra resultado:
  [65, 30, 5, 0, 0, 0, 0, 0]
  â†’ 65 SÃ­, 30 No, 5 Abstenciones
  â†’ Propuesta APROBADA (65%)
```

---

## Limitaciones Actuales

1. **TamaÃ±o del Vector**: MÃ¡ximo 8 opciones por pregunta (con poly_degree=8)
2. **Solo Sumas**: El sistema actual solo soporta suma homomÃ³rfica
3. **No MultiplicaciÃ³n**: No se implementa multiplicaciÃ³n de respuestas
4. **ParÃ¡metros de Demo**: Los parÃ¡metros actuales son para demostraciÃ³n, no producciÃ³n

### Mejoras Futuras

- [ ] Soporte para mÃ¡s opciones (poly_degree=16, 32, ...)
- [ ] MultiplicaciÃ³n homomÃ³rfica para estadÃ­sticas complejas
- [ ] Rotaciones para operaciones avanzadas
- [ ] ParÃ¡metros de seguridad para producciÃ³n
- [ ] Interfaz de administraciÃ³n web
- [ ] Export de resultados a CSV/PDF
